<script>
    const SHEET_ID = '12eyXAI9-hT0TFSx2HhVDUWHXo4X9QVT-vSPmGQBx6c8';
    const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

    async function init() {
        const grid = document.getElementById('video-grid');
        try {
            const res = await fetch(SHEET_URL);
            const text = await res.text();
            const json = JSON.parse(text.substring(47).slice(0, -2));
            const rows = json.table.rows;

            grid.innerHTML = ''; 

            rows.forEach((row, index) => {
                if (index === 0) return;

                const video = {
                    title: row.c[1] ? row.c[1].v : "Untitled",
                    category: row.c[2] ? row.c[2].v : "General",
                    // Adding a timestamp to the URL to force a fresh load
                    thumb: row.c[4] ? row.c[4].v + '?t=' + Date.now() : "",
                    preview: row.c[5] ? row.c[5].v : ""
                };

                const card = document.createElement('div');
                card.className = "bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100 p-4 transition hover:shadow-xl";
                card.innerHTML = `
                    <div class="relative aspect-video bg-gray-100 rounded-xl overflow-hidden mb-4">
                        <img src="${video.thumb}" class="w-full h-full object-cover" 
                             onerror="this.src='https://via.placeholder.com/600x400?text=Permission+Denied+on+GCP'">
                    </div>
                    <h4 class="font-bold text-gray-800 text-lg">${video.title}</h4>
                    <p class="text-[10px] text-blue-600 font-black uppercase mt-1 tracking-widest">${video.category}</p>
                `;
                grid.appendChild(card);
            });
        } catch (err) {
            console.error("Connection failed:", err);
        }
    }
    init();
</script>
