<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nmediaservices Stockflow | Premium Footage Marketplace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-gray-50 font-sans text-gray-900">

    <!-- ===================== NAVBAR ===================== -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="./assets/logo.png" alt="Nmediaservices Logo"
                     class="h-10 w-auto max-w-[150px]" onerror="this.style.display='none'">
                <h1 class="text-xl font-bold tracking-tight text-gray-900">
                    Nmediaservices<span class="text-teal-500">Stockflow</span>
                </h1>
            </div>

            <!-- Wallet Widget -->
            <div id="walletWidget">
                <button id="loginButton" onclick="showLoginModal()"
                    style="background:#14B8A6;color:white;padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;">
                    Sign In
                </button>

                <div id="walletDisplay" style="display:none;">
                    <div style="display:flex;align-items:center;gap:15px;">
                        <div style="background:#E0F2FE;padding:8px 15px;border-radius:6px;">
                            <span style="font-size:14px;color:#0369A1;">Wallet:</span>
                            <strong id="walletAmount" style="color:#14B8A6;font-size:18px;">$0.00</strong>
                        </div>
                        <button onclick="showTopUpModal()"
                            style="background:#14B8A6;color:white;padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;">
                            Add Funds
                        </button>
                        <div style="position:relative;">
                            <button id="userMenuButton" onclick="toggleUserMenu()"
                                style="background:#F3F4F6;padding:8px 12px;border:none;border-radius:6px;cursor:pointer;">
                                <span id="userEmailDisplay"></span> ‚ñº
                            </button>
                            <div id="userMenu"
                                style="display:none;position:absolute;right:0;top:100%;margin-top:5px;background:white;border:1px solid #E5E7EB;border-radius:6px;box-shadow:0 4px 6px rgba(0,0,0,0.1);min-width:200px;z-index:100;">
                                <a href="#" onclick="logout();return false;"
                                    style="display:block;padding:10px 15px;color:#EF4444;text-decoration:none;">
                                    üö™ Logout
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ===================== HERO ===================== -->
    <header class="bg-gradient-to-br from-teal-500 to-teal-700 text-white py-20 px-6">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-5xl font-extrabold mb-4 tracking-tight">Premium Stock Footage</h2>
            <p class="text-xl text-teal-100 mb-8">Discover high-quality videos for your creative projects</p>
            <div class="relative max-w-2xl mx-auto">
                <input type="text" id="searchInput"
                    placeholder="Search footage by title, description, or tags..."
                    class="w-full px-6 py-4 pr-32 rounded-full text-gray-900 text-lg focus:outline-none focus:ring-4 focus:ring-teal-300 shadow-xl"
                    oninput="filterVideos()">
                <button class="absolute right-2 top-2 bg-teal-600 text-white px-8 py-2 rounded-full font-semibold hover:bg-teal-700 transition">
                    Search
                </button>
            </div>
        </div>
    </header>

    <!-- ===================== FILTERS ===================== -->
    <div class="bg-white border-b border-gray-200 sticky top-[73px] z-40 shadow-sm">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="mb-4">
                <div class="flex items-center justify-between mb-3">
                    <p class="text-sm font-bold text-gray-700 uppercase tracking-wide">Browse Categories</p>
                    <p class="text-xs text-gray-500" id="resultCount">Loading...</p>
                </div>
                <div class="flex flex-wrap gap-2" id="categoryButtons"></div>
            </div>

            <!-- Subcategories -->
            <div id="subcategorySection" class="mb-4 hidden">
                <div class="bg-teal-50 border border-teal-200 rounded-xl p-4">
                    <p class="text-sm font-semibold text-teal-800 mb-3" id="subcategoryTitle">Subcategories</p>
                    <div class="flex flex-wrap gap-2" id="subcategoryButtons"></div>
                </div>
            </div>

            <!-- Sub types -->
            <div id="subSection" class="mb-4 hidden">
                <div class="bg-purple-50 border border-purple-200 rounded-xl p-4">
                    <p class="text-sm font-semibold text-purple-800 mb-3" id="subTitle">Types</p>
                    <div class="flex flex-wrap gap-2" id="subButtons"></div>
                </div>
            </div>

            <!-- Format buttons -->
            <div class="flex items-center gap-3">
                <p class="text-xs font-semibold text-gray-600 uppercase tracking-wide">Format</p>
                <div class="flex gap-2">
                    <button class="format-btn active px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-100 text-gray-700 hover:bg-teal-500 hover:text-white transition"
                            data-format="all" onclick="filterByFormat('all')">All</button>
                    <button class="format-btn px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-100 text-gray-700 hover:bg-teal-500 hover:text-white transition"
                            data-format="9:16" onclick="filterByFormat('9:16')">üì± 9:16</button>
                    <button class="format-btn px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-100 text-gray-700 hover:bg-teal-500 hover:text-white transition"
                            data-format="16:9" onclick="filterByFormat('16:9')">üñ•Ô∏è 16:9</button>
                    <button class="format-btn px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-100 text-gray-700 hover:bg-teal-500 hover:text-white transition"
                            data-format="1:1" onclick="filterByFormat('1:1')">‚¨ú 1:1</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===================== STATUS ===================== -->
    <div class="max-w-7xl mx-auto px-6 py-4">
        <p id="status-text" class="text-sm text-gray-500">
            <span class="inline-block w-2 h-2 bg-teal-500 rounded-full animate-pulse mr-2"></span>
            Loading footage...
        </p>
    </div>

    <!-- ===================== VIDEO GRID ===================== -->
    <main class="max-w-7xl mx-auto px-6 pb-16">
        <div id="video-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
        <div id="loadMoreSection" class="text-center mt-8 hidden">
            <button onclick="loadMore()" class="bg-teal-500 text-white px-8 py-3 rounded-xl font-semibold hover:bg-teal-600 transition">
                Load More
            </button>
        </div>
    </main>

    <!-- ===================== PREVIEW MODAL ===================== -->
    <div id="previewModal" class="modal-hidden fixed inset-0 bg-black/95 z-[60] items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl overflow-hidden max-w-5xl w-full shadow-2xl relative">
            <button onclick="closeModal()" class="absolute top-4 right-4 z-50 bg-black/70 text-white rounded-full p-2.5 hover:bg-black transition">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <video id="modalVideo" controls class="w-full aspect-video bg-black" src=""></video>
            <div class="p-6">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4">
                    <div class="flex-1">
                        <h3 id="modalTitle" class="text-2xl font-bold text-gray-900 mb-2"></h3>
                        <div class="flex items-center gap-2 text-sm flex-wrap mb-2">
                            <span id="modalCategory" class="px-3 py-1 bg-teal-100 text-teal-700 rounded-lg font-medium"></span>
                            <span id="modalSubcategory" class="px-3 py-1 bg-blue-100 text-blue-700 rounded-lg font-medium"></span>
                            <span id="modalSub" class="px-3 py-1 bg-purple-100 text-purple-700 rounded-lg font-medium"></span>
                            <span id="modalFormat" class="text-gray-600"></span>
                            <span id="modalResolution" class="text-gray-600"></span>
                        </div>
                        <div id="modalTags" class="flex flex-wrap gap-1 mt-2"></div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="text-right">
                            <p class="text-sm text-gray-500">License from</p>
                            <p class="text-3xl font-bold text-gray-900">$<span id="modalPrice"></span></p>
                        </div>
                        <button onclick="handlePurchase()" class="bg-teal-500 text-white px-8 py-3 rounded-xl font-bold hover:bg-teal-600 transition shadow-lg shadow-teal-200">
                            Buy Now
                        </button>
                    </div>
                </div>
                <p id="modalDescription" class="text-gray-600 text-sm"></p>
            </div>
        </div>
    </div>

    <!-- ===================== LOGIN MODAL ===================== -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeLoginModal()">&times;</span>
            <h2>Sign In to StockFlow</h2>
            <p style="color:#666;margin-bottom:20px;">Enter your email to continue</p>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <input type="email" id="userEmail" placeholder="your@email.com" required
                    style="width:100%;padding:12px;border:2px solid #14B8A6;border-radius:8px;font-size:16px;margin-bottom:15px;box-sizing:border-box;"/>
                <button type="submit"
                    style="width:100%;background:#14B8A6;color:white;padding:12px;border:none;border-radius:8px;font-size:16px;font-weight:bold;cursor:pointer;">
                    Continue
                </button>
            </form>
            <p style="font-size:12px;color:#999;margin-top:15px;text-align:center;">No password needed. We'll remember you on this device.</p>
        </div>
    </div>

    <!-- ===================== TOP-UP MODAL ===================== -->
    <div id="topUpModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeTopUpModal()">&times;</span>
            <h2>Add Funds to Wallet</h2>
            <p style="color:#666;margin-bottom:20px;">Choose an amount to add to your wallet</p>
            <div style="display:grid;gap:15px;">
                <button onclick="addFunds(10)" class="topup-button">
                    <span style="font-size:24px;font-weight:bold;">$10</span>
                    <span style="font-size:14px;color:#666;">Quick top-up</span>
                </button>
                <button onclick="addFunds(20)" class="topup-button">
                    <span style="font-size:24px;font-weight:bold;">$20</span>
                    <span style="font-size:14px;color:#666;">Most popular</span>
                </button>
                <button onclick="addFunds(30)" class="topup-button">
                    <span style="font-size:24px;font-weight:bold;">$30</span>
                    <span style="font-size:14px;color:#666;">Best value</span>
                </button>
            </div>
            <p style="font-size:12px;color:#999;margin-top:15px;text-align:center;">Secure payment powered by Stripe</p>
        </div>
    </div>

    <!-- ===================== DOWNLOAD MODAL ===================== -->
    <div id="downloadModal" class="modal">
        <div class="modal-content" style="text-align:center;">
            <span class="close-modal" onclick="closeDownloadModal()">&times;</span>
            <div style="font-size:60px;margin-bottom:20px;">‚úÖ</div>
            <h2>Purchase Successful!</h2>
            <p id="downloadVideoTitle" style="color:#666;margin-bottom:20px;"></p>
            <a id="downloadLink" href="#" target="_blank"
                style="display:inline-block;background:#14B8A6;color:white;padding:15px 40px;text-decoration:none;border-radius:8px;font-weight:bold;margin:20px 0;">
                üì• Download High-Res File
            </a>
            <p style="font-size:14px;color:#999;">A download link has also been sent to your email.</p>
        </div>
    </div>

    <!-- ===================== NOTIFICATION TOAST ===================== -->
    <div id="notification"
        style="display:none;position:fixed;top:20px;right:20px;background:#14B8A6;color:white;padding:15px 20px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);z-index:1001;max-width:300px;">
        <p id="notificationMessage" style="margin:0;"></p>
    </div>

    <!-- ===================== SCRIPTS (ORDER MATTERS!) ===================== -->
    <script src="js/config.js"></script>
    <script src="js/modals.js"></script>
    <script src="js/videos.js"></script>
    <script src="js/wallet.js"></script>
    <script>
        // Start the app
        init();
    </script>

</body>
</html>
